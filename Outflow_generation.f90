!****************************************************************
		SUBROUTINE OUTFLOW_GENERATION (jyear,outflow)
!****************************************************************
      USE DLMWQ_VARIABLES      
      USE DLMWQ_SERVICES
		IMPLICIT NONE
      SAVE

		INTEGER*4 i, jyear,month_dayGY(12),month_dayLY(12)
		INTEGER*4 mm
      REAL*8  outc0(12), outc1(12), outc2(12), outc3(12), outc4(12),outc5(12),outc6(12)
      DATA outc0 /0.48850890,	0.67038833,	-1.78254659, -9.91305770,		&
     	        18.68839430, 41.97161437, -79.78086257, -2.65473673,		&
                 -0.28068178, 0.07800260, 0.41632799, 0.03710574/ 
      DATA outc1 / -19.91314681, -16.44276584, 46.13779421, 				&
                  135.66231986, -151.69521495, -154.01720169,				&
     					670.02469551, 12.66268100, 2.41077130, 					&
     					1.74534042, -14.41101419, -2.03481617/
      DATA outc2 / 257.37617322, 189.19304570, -220.87224670, 				&
     	            -563.48475786, 537.38949119, 125.54713378,				&
     					-1939.35377097, 165.26401408, 119.40649977,				&
     					58.18407796, 239.32937995, 91.01077287/
		DATA outc3 /-820.74959840, -537.82390316, 447.03501042,				&
     	            1095.24074040, -944.19140687, 144.11043931, 				&
     					2788.57752873, -480.78457574, -296.03949344,				&
     					-87.20104981, -657.07671015, -297.65892923/			
		DATA outc4 /1103.46338153,	673.24294825, -407.37844560,				&
     	           -1060.09754120, 868.63085552, -242.31669797,				&	
     					-2126.93874766, 514.25019820, 302.39066969,				& 
     					12.80370314, 714.98342347, 482.21275704/
		DATA outc5 /-655.31188802, -387.96818365, 162.21333510,				& 
     	             495.67080236, -398.31578543, 105.99405037,				&
     					823.92342801, -243.19533558, -149.47773131,				&
     					42.27041859, -319.17519546, -367.62048719/
		DATA outc6 / 140.90158130, 83.63136061, -21.52157142, 				&
     	             -89.32021004, 71.55392858, -13.65427103,					&
     					-127.60858061, 42.74850838, 29.65395945, 					&
     				 -20.15674591, 41.87418111, 102.92076911/
      DATA month_dayGY /31, 59, 90, 120, 151, 181, 212, 243, 273, 304,334, 365/
      DATA month_dayLY /31, 60, 91, 121, 152, 182, 213, 244, 274, 305,335, 366/

		REAL*8 lake_rim, rim2WS, outflow
		PARAMETER (lake_rim = 1896.77)
	  
      mm=1
      IF(mod(jyear,4).eq.0) THEN
			DO i= 1, 11
				IF(jday.gt.month_dayLY(mm)) THEN
					mm=mm+1
				ELSE
					GOTO 1
				ENDIF
			ENDDO
		ELSE
			DO i= 1, 11
				IF(jday.gt.month_dayGY(mm)) THEN
					mm=mm+1
				ELSE
					GOTO 1
				ENDIF
			ENDDO
		ENDIF
  1	CONTINUE
    	rim2WS=depth(ns)-OLEV(1)
		IF(rim2WS.LE.0.0)THEN
			outflow=0.0
		ELSE
			outflow=outc0(mm)+outc1(mm)*rim2WS+outc2(mm)*rim2WS**2+	&
     		        outc3(mm)*rim2WS**3+outc4(mm)*rim2WS**4+			&
     				  outc5(mm)*rim2WS**5+outc6(mm)*rim2WS**6
			IF(outflow.le.0.0) outflow =0.0
		ENDIF

!------Above outflow is m3/s-----------------
!------DLM needs 10^3 m3/d--------------
       outflow=outflow*86400.0/1000.0         
!      print*, jday,outflow, rim2WS, depth(ns)
	
		RETURN
		END SUBROUTINE OUTFLOW_GENERATION